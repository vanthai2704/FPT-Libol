
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta http-equiv="content-type" content="text/plain; charset=UTF-8" />
    <link rel="stylesheet" type="text/css" href="~/Content/DataTables/DataTables-1.10.18/css/dataTables.bootstrap4.css">

    <style>
        .hide {
            display: none;
        }
    </style>
    <script>
        $(document).ready(function () {
            var general_tbl = $("#general_tbl").DataTable({
                paging: false,
                searching: false,
                info: false,
                order: false,
                buttons: [
                    {
                        extend: 'excel',
                        title: function () { var printTitle = 'Báo cáo Chuyên ngành'; return printTitle; }
                    },
                ],
            });

            var table = $("#table").DataTable({
                columnDefs: [{
                    "searchable": false,
                    "orderable": false,
                    "targets": 0
                }],
                order: [[1, 'asc']],
                buttons: [
                    {
                        extend: 'excel',
                        title: function () { var printTitle = 'Báo cáo Chuyên ngành'; return printTitle; }
                    },
                ],
            });

            //var data = general_tbl.data().concat(table.data());

            table.on('order.dt search.dt', function () {
                table.column(0, { search: 'applied', order: 'applied' }).nodes().each(function (cell, i) {
                    cell.innerHTML = i + 1;
                });
            }).draw();

            $("#ExportReporttoExcel").on("click", function () {
                table.button('.buttons-excel').trigger();
            });
        });

    </script>
</head>
<body>
    @if (ViewBag.Result.Count < 1)
    {
        <h5 class="text-center" style="margin-top: 150px;">Không có dữ liệu</h5>
    }
    else
    {
        <table id="general_tbl" class="table table-striped table-bordered" style="margin: auto; width: 40%;">
            <thead>
                <tr>
                    <th></th>
                    <th>Số tên sách</th>
                    <th>Số bản sách</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Tổng Giáo trình</td>
                    <td>@ViewBag.GTItem</td>
                    <td>@ViewBag.GT</td>
                </tr>
                <tr>
                    <td>Tổng Tham khảo</td>
                    <td>@ViewBag.TKItem</td>
                    <td>@ViewBag.TK</td>
                </tr>
                <tr>
                    <td>Tổng</td>
                    <td>@ViewBag.TTItem</td>
                    <td>@ViewBag.TT</td>
                </tr>
            </tbody>
        </table>
        <br />
        <table id="table" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th style="text-align:center;">STT</th>
                    <th>Mã môn</th>
                    <th>Tên sách</th>
                    <th>Mã tài liệu</th>
                    <th>ISBN</th>
                    <th>Tác giả</th>
                    <th>Nhà xuất bản</th>
                    <th>Số lượng</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var i in ViewBag.Result)
                {
                    <tr>
                        <td style="text-align:center;"></td>
                        <td>@i.SUBJECTCODE</td>
                        <td>@i.ITEMNAME</td>
                        <td>@i.ITEMCODE</td>
                        <td>@i.ISBN.ToString()</td>
                        <td>@i.AUTHOR</td>
                        <td>@i.PUBLISHER</td>
                        <td>@i.TOTAL</td>
                    </tr>
                }
            </tbody>
        </table>
        <div class="row">
            <div class="col-md-12 text-center">
                <button type="button" id="ExportReporttoExcel" class="btn btn-primary">Lưu vào file excel</button>
            </div>
        </div>
    }
</body>